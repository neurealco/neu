const t=document.getElementById("refresh-stats");t&&t.addEventListener("click",async()=>{try{const e=await fetch("undefined/dashboard/refresh",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}});if(e.ok)alert("Stats refreshed successfully!"),window.location.reload();else{const r=await e.json();if(r.error?.includes("Monthly usage limit exceeded"))alert(`You've reached your monthly limit for stats refresh (${r.limit}). Upgrade your plan for more refreshes.`);else throw new Error(r.error||"Failed to refresh stats")}}catch(e){console.error("Refresh error:",e);let r="Error refreshing stats";e instanceof Error?r=e.message:typeof e=="string"&&(r=e),alert(r)}});
